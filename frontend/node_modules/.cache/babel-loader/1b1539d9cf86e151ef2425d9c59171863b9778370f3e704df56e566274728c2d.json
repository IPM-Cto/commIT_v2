{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\muletto1\\\\WebstormProjects\\\\commIT_v2\\\\frontend\\\\src\\\\components\\\\PrivateRoute.js\",\n  _s = $RefreshSig$();\n// PrivateRoute.js\nimport React from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { useAuth0 } from '@auth0/auth0-react';\nimport { useUser } from '../contexts/UserContext';\nimport LoadingScreen from './LoadingScreen';\n\n/**\n * üî• PRIVATE ROUTE - SOLUZIONE 2B HYBRID\n * \n * Protegge le route e verifica opzionalmente il user_type\n * Supporta accesso immediato da localStorage\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PrivateRoute = ({\n  children,\n  requiredUserType = null\n}) => {\n  _s();\n  const {\n    isAuthenticated,\n    isLoading: authLoading\n  } = useAuth0();\n  const {\n    userData,\n    userType,\n    loading: userLoading\n  } = useUser();\n  console.log('üîí PrivateRoute check:', {\n    isAuthenticated,\n    authLoading,\n    userLoading,\n    userData: !!userData,\n    userType,\n    requiredUserType\n  });\n\n  // Mostra loading solo se stiamo ancora caricando E non abbiamo dati\n  const effectiveUserType = (userData === null || userData === void 0 ? void 0 : userData.user_type) || userType || localStorage.getItem('user_type');\n  if (authLoading || userLoading && !effectiveUserType) {\n    console.log('‚è≥ PrivateRoute: Loading...');\n    return /*#__PURE__*/_jsxDEV(LoadingScreen, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Check autenticazione\n  if (!isAuthenticated) {\n    console.warn('‚ö†Ô∏è PrivateRoute: Not authenticated, redirect to /login');\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Se √® richiesto un user_type specifico, verificalo\n  if (requiredUserType) {\n    console.log('üîç PrivateRoute: Checking user type...', {\n      required: requiredUserType,\n      actual: effectiveUserType\n    });\n\n    // Se non abbiamo user_type, redirect a registrazione\n    if (!effectiveUserType) {\n      console.warn('‚ö†Ô∏è PrivateRoute: No user type, redirect to /register');\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/register\",\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 14\n      }, this);\n    }\n\n    // Se user_type non corrisponde, redirect alla dashboard corretta\n    if (effectiveUserType !== requiredUserType) {\n      console.warn('‚ö†Ô∏è PrivateRoute: Wrong user type!', {\n        required: requiredUserType,\n        actual: effectiveUserType\n      });\n\n      // Redirect alla dashboard corretta per questo user type\n      const correctDashboard = effectiveUserType === 'provider' ? '/dashboard/provider' : effectiveUserType === 'customer' ? '/dashboard/customer' : '/dashboard';\n      console.log('üîÑ PrivateRoute: Redirecting to correct dashboard:', correctDashboard);\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: correctDashboard,\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 14\n      }, this);\n    }\n  }\n  console.log('‚úÖ PrivateRoute: Access granted');\n  return children;\n};\n_s(PrivateRoute, \"t1Z67NzvX2s2WIYkN2nS3ThmuhQ=\", false, function () {\n  return [useAuth0, useUser];\n});\n_c = PrivateRoute;\nexport default PrivateRoute;\nvar _c;\n$RefreshReg$(_c, \"PrivateRoute\");","map":{"version":3,"names":["React","Navigate","useAuth0","useUser","LoadingScreen","jsxDEV","_jsxDEV","PrivateRoute","children","requiredUserType","_s","isAuthenticated","isLoading","authLoading","userData","userType","loading","userLoading","console","log","effectiveUserType","user_type","localStorage","getItem","fileName","_jsxFileName","lineNumber","columnNumber","warn","to","replace","required","actual","correctDashboard","_c","$RefreshReg$"],"sources":["C:/Users/muletto1/WebstormProjects/commIT_v2/frontend/src/components/PrivateRoute.js"],"sourcesContent":["// PrivateRoute.js\nimport React from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { useAuth0 } from '@auth0/auth0-react';\nimport { useUser } from '../contexts/UserContext';\nimport LoadingScreen from './LoadingScreen';\n\n/**\n * üî• PRIVATE ROUTE - SOLUZIONE 2B HYBRID\n * \n * Protegge le route e verifica opzionalmente il user_type\n * Supporta accesso immediato da localStorage\n */\nconst PrivateRoute = ({ children, requiredUserType = null }) => {\n  const { isAuthenticated, isLoading: authLoading } = useAuth0();\n  const { userData, userType, loading: userLoading } = useUser();\n\n  console.log('üîí PrivateRoute check:', {\n    isAuthenticated,\n    authLoading,\n    userLoading,\n    userData: !!userData,\n    userType,\n    requiredUserType\n  });\n\n  // Mostra loading solo se stiamo ancora caricando E non abbiamo dati\n  const effectiveUserType = userData?.user_type || userType || localStorage.getItem('user_type');\n  \n  if (authLoading || (userLoading && !effectiveUserType)) {\n    console.log('‚è≥ PrivateRoute: Loading...');\n    return <LoadingScreen />;\n  }\n\n  // Check autenticazione\n  if (!isAuthenticated) {\n    console.warn('‚ö†Ô∏è PrivateRoute: Not authenticated, redirect to /login');\n    return <Navigate to=\"/login\" replace />;\n  }\n\n  // Se √® richiesto un user_type specifico, verificalo\n  if (requiredUserType) {\n    console.log('üîç PrivateRoute: Checking user type...', {\n      required: requiredUserType,\n      actual: effectiveUserType\n    });\n\n    // Se non abbiamo user_type, redirect a registrazione\n    if (!effectiveUserType) {\n      console.warn('‚ö†Ô∏è PrivateRoute: No user type, redirect to /register');\n      return <Navigate to=\"/register\" replace />;\n    }\n\n    // Se user_type non corrisponde, redirect alla dashboard corretta\n    if (effectiveUserType !== requiredUserType) {\n      console.warn('‚ö†Ô∏è PrivateRoute: Wrong user type!', {\n        required: requiredUserType,\n        actual: effectiveUserType\n      });\n      \n      // Redirect alla dashboard corretta per questo user type\n      const correctDashboard = effectiveUserType === 'provider'\n        ? '/dashboard/provider'\n        : effectiveUserType === 'customer'\n        ? '/dashboard/customer'\n        : '/dashboard';\n      \n      console.log('üîÑ PrivateRoute: Redirecting to correct dashboard:', correctDashboard);\n      return <Navigate to={correctDashboard} replace />;\n    }\n  }\n\n  console.log('‚úÖ PrivateRoute: Access granted');\n  return children;\n};\n\nexport default PrivateRoute;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}